---
title: "Base Model"
author: "Simon Schrauth"
date: "`r Sys.Date()`"
output: html_document
---
# Model Compas Dataset

## Goal

After executing this script, the base model (logistic regression) for the COMPAS data set should be completed.

## Install packages

```{r}
pacman::p_load(tidyverse, 
               here,
               tidymodels)

tidymodels_prefer()
```

## Load data

```{r}
data = readRDS(here("01_data", "02_data_processed", "01_base_model",
                    "03_data.rds"))
```

## Data preparation
# Final Data Transformation
```{r}
recipe = recipe(compas ~ .,
                data = data) %>% 
  step_dummy(all_nominal_predictors())
```

## Modelling (Logistic Regression)

```{r}
model = logistic_reg() %>% 
  set_engine("glm") %>% 
  set_mode("classification")

workflow = workflow() %>% 
  add_model(model) %>% 
  add_recipe(recipe)

model_fit = 
  workflow %>% 
  fit(data = data)

estimation = tidy(model_fit, exponentiate = TRUE)

estimation %>% 
  slice(-1) %>% 
  mutate(estimate_percent = percent((estimate - 1), digits = 1)) %>% 
  relocate(estimate_percent, .after = estimate)
```


```{r}
saveRDS(model_fit, 
        file = here("01_data", "02_data_processed", "01_base_model",
                    "04_model_fit.rds")
        )
```


